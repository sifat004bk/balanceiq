#!/bin/sh
echo "ğŸ” Running pre-commit checks..."

# 1. Check Formatting
echo "ğŸ¨ 1/2 Checking formatting..."
if ! dart format --set-exit-if-changed .; then
  echo "âŒ Formatting check failed. Run 'dart format .' to fix."
  exit 1
fi

# 2. Run Analyzer
# NOTE: Using --no-fatal-infos for now to allow existing info-level issues.
# User can switch to --fatal-infos when the backlog is cleared.
echo "ğŸ•µï¸ 2/2 Running analyzer..."
if ! flutter analyze --no-fatal-infos; then
  echo "âŒ Analyzer check failed. Fix errors before committing."
  exit 1
fi

# 3. Tests are disabled for faster commits
# Uncomment below to re-enable tests:
# echo "ğŸ§ª 3/3 Running tests..."
# if ! flutter test; then
#   echo "âŒ Tests failed. Fix tests before committing."
#   exit 1
# fi

echo "âœ… All checks passed!"
